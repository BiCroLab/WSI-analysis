## Software used
* vips
* exiftool
* bioimage converter
* UMAP
* HDBSCAN

## Pipeline
### Segmentation
.svs files and .nd2 files need to be processed differently. 
* svs files can be all processed in qupath 
* small nd2 files (< 2GB) can be processed in qupath directly
* large nd2 files (> 2GB) are converted into tif, split into vertical chuncks and then processed in qupath 
### Morphology table
The morphology table is the one generated by qupath 
### Graph
Is the 1-simplex originated by UMAP in the uniform manifold approximation step. It allows to quantify the weighted degree and the clustering coefficients.
### Graph Laplacian of the morphology
By constructing the graph Laplacian we can measure the differential structure of morphological and topological features
### Selection of relevant morphological and topological features
Decide which features to include in the downstream analysis
### Stratification of individual morphometric feature
Divide in quantiles the range of values for each morphometric feature
### Subgraph creation
For each morphometric feature and quantile pair list all connected subgraphs such that every node in the subgraph belong to the same feature-quantile pair, and such that the number of nodes in the connected subgraph is above a threshold 
### Covariance descriptor of the partitions
Construct the covariance descriptor for each subgraph
### Clustering of the descriptors
Cluster the covariance descriptors
### Assign unlabelled nodes to clusters
Determined the connected components of the unlabelled nodes (above a given threshold in size) and for each component construct its covariance descriptor and find the closed descriptor in the set of clustered descriptor. The new descriptor will inherit the same cluster label
